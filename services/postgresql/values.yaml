global:
  postgresql:
    auth:
      username: gitlab
      database: gitlabhq_production
      existingSecret: postgres-secrets
      secretKeys:
        adminPasswordKey: postgres-password
        userPasswordKey: gitlab-password
        replicationPasswordKey: replication-password

# architecture: standalone

primary:
  name: primary
  resourcesPreset: "small"
  startupProbe:
    enabled: true
    initialDelaySeconds: 90
    periodSeconds: 20
    timeoutSeconds: 10
    failureThreshold: 30
    successThreshold: 1
  livenessProbe:
    enabled: true
    initialDelaySeconds: 120
    periodSeconds: 10
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1
  readinessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1
  # resources:
  #   requests:
  #     cpu: 600m
  #     memory: 512Mi
  #   limits:
  #     cpu: 1
  #     memory: 1Gi
  persistence:
    enabled: true
    size: 20Gi

architecture: replication

replication:
  synchronousCommit: "remote_apply"

readReplicas:
  name: secondary
  replicaCount: 2
  resourcesPreset: "small"
  startupProbe:
    enabled: true
    initialDelaySeconds: 120
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 30
    successThreshold: 1
  livenessProbe:
    enabled: true
    initialDelaySeconds: 160
    periodSeconds: 15
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1
  readinessProbe:
    enabled: true
    initialDelaySeconds: 40
    periodSeconds: 10
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1
  # resources:
  #   requests:
  #     cpu: 300m
  #     memory: 256Mi
  #   limits:
  #     cpu: 600m
  #     memory: 512Mi
  persistence:
    enabled: true
    size: 20Gi

volumePermissions:
  enabled: true
  resourcesPreset: "small"
  # resources:
  #   requests:
  #     cpu: 500m
  #     memory: 512Mi
  #   limits:
  #     cpu: 1
  #     memory: 1Gi

metrics:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: 120s
    labels:
      release: prometheus
  startupProbe:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 20
    timeoutSeconds: 20
    successThreshold: 1
    failureThreshold: 10
  livenessProbe:
    enabled: true
    initialDelaySeconds: 90
    periodSeconds: 10
    timeoutSeconds: 10
    successThreshold: 1
    failureThreshold: 5
  readinessProbe:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 5
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 3
  # resources:
  #   requests:
  #     cpu: 200m
  #     memory: 128Mi
  #   limits:
  #     cpu: 400m
  #     memory: 256Mi